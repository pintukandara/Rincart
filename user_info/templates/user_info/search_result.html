{% extends "user_info/base.html" %}
{% load static %}

{% block title %}Search Results for "{{ query }}"{% endblock title %}

{% block extra_head %}
    {# Link to the new stylesheet #}
    <link rel="stylesheet" href="{% static 'user_info/search_results.css' %}">
{% endblock extra_head %}

{% block content %}
<h2>Search Results for "{{ query }}"</h2>

{% if results %}
    <ul class="product-list">
        {% for product in results %}
            <li>
                {# The article is now the card container #}
                <article class="product-card">

                    {# Product image is a link #}
                    <a href="{{ product.get_absolute_url }}">
                        {% if product.image %}
                            <img src="{{ product.image.url }}" alt="{{ product.title }}">
                        {% else %}
                            {# Optional: Placeholder for products without an image #}
                            <img src="{% static 'user_info/list.png' %}" alt="No image available">
                        {% endif %}
                    </a>
                    
                    <div class="product-content">
                        {# Product title is also a link #}
                        <a href="{{ product.get_absolute_url }}">
                            <h1>{{ product.title }}</h1>
                        </a>
                        <p class="description">{{ product.description|truncatewords:20 }}</p>
                        <p class="price">â‚¹{{ product.price }}</p>
                    </div>
                    
                    {# The form is now separate for valid HTML structure #}
                    <div class="buy-btn-form">
                        <form method="POST" action="{% url 'address' product.id %}">
                            {% csrf_token %}
                            <button type="submit" class="buy-btn">Buy Now</button>
                        </form>
                    </div>

                </article>
            </li>
        {% endfor %}
    </ul>
{% else %}
    <p class="no-results">ðŸ˜ž No products found matching your search.</p>
{% endif %}

{% endblock content %}